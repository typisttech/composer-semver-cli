#!/usr/bin/env php
<?php

declare(strict_types=1);

namespace TypistTech\ComposerSemVer;

use function in_array;
use const PHP_EOL;
use const PHP_SAPI;
use RuntimeException;

// Taken from https://box-project.github.io/box/faq/#what-is-the-canonical-way-to-write-a-cli-entry-file
if (!in_array(PHP_SAPI, ['cli', 'phpdbg', 'embed'], true)) {
    echo PHP_EOL . 'This app may only be invoked from a command line, got "' . PHP_SAPI . '"' . PHP_EOL;
    exit(1);
}

(static function (): void {
    if (isset($_composer_autoload_path)
        && is_readable($_composer_autoload_path)
    ) {
        include_once $_composer_autoload_path;

        return;
    }

    if (is_readable(__DIR__ . '/../vendor/autoload.php')) {
        include_once __DIR__ . '/../vendor/autoload.php';

        return;
    }

    if (is_readable(__DIR__ . '/../../../autoload.php')) {
        include_once __DIR__ . '/../../../autoload.php';

        return;
    }

    throw new RuntimeException('Unable to find the Composer autoloader.');
})();

Application::run();
